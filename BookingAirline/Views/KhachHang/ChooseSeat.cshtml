@model IEnumerable<BookingAirline.Models.Ve>
@using BookingAirline.Models;

@{
    ViewBag.Title = "ChooseSeat";
    Layout = "~/Views/KhachHang/Shared/_LayoutPage1.cshtml";
    BookingAirLightEntities database = new BookingAirLightEntities();
    var macb = ViewData["MaCB"];

}
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>

<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<h2 style="text-align:center">ChooseSeat @macb</h2>
<link href="~/Style/Css/style.css" rel="stylesheet" />
<div class="container">
    <form action="/KhachHang/ChooseSeat" method="post" id="submit">
        <div class="col">
            <div class="col-lg-6">
                <div class="plane">
                    <div class="cockpit">
                        <h1>
                            Please select 1 or more seats !
                        </h1>
                    </div>
                    <div class="exit exit--front fuselage">

                    </div>
                    <ol class="cabin fuselage">
                        @{
                            var stt = 1;
                            var stt2 = 1;
                            if ((Model.Count()) > 0)
                            {
                                var row = ((Model.Count()) / 6) + 1;
                                for (int i = 1; i < row + 1; i++)
                                {
                                    <li class="row row--1">
                                        <ol class="seats" type="A">
                                            @{
                                                for (int y = stt2; y <= 6 * stt; y++)
                                                {
                                                    var slot = database.Ves.Where(s => s.MaVe == "VE" + stt2).FirstOrDefault();
                                                    if (slot != null)
                                                    {
                                                        if (slot.TinhTrang == "Chưa đặt chỗ")
                                                        {
                                                            <li class="seat">
                                                                <input type="checkbox" id="@stt2" value="@slot.MaVe" />
                                                                <label for="@stt2">@stt2</label>
                                                            </li>
                                                        }
                                                        else
                                                        {
                                                            <li class="seat">
                                                                <input disabled type="checkbox" id="@stt2" value="@slot.MaVe" />
                                                                <label for="@stt2">@stt2</label>
                                                            </li>
                                                        }

                                                        stt2++;
                                                    }

                                                }
                                            }
                                        </ol>
                                    </li>
                                    stt++;
                                }
                            }

                        }
                    </ol>
                    <div class="exit exit--back fuselage">

                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="booking-details">
                    <h2>Booking Details</h2>
                    <h3> Selected Seats (<span id="counter">0</span>):</h3>
                    <ul id="selected-seats">
                    </ul>
                    <button type="submit" class="btn btn-success" value="">Next</button>
                    <div id="legend"></div>
                </div>
            </div>
        </div>

    </form>
</div>

<!-- partial -->
<script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js'></script>
<script src="~/Style/Js/script.js"></script>
<script>
    var html = "";
    var quantity = 0;
    $('input[type="checkbox"]').change(function () {

        var $this = $(this);
        console.log("Bạn chọn", $this.val());
        if ($this.is(":checked")) {
            quantity++;
            html = `<div id="${$this.val()}">
                        <p style="font-size:20px">
                            Bạn đã chọn vé:  ${$this.val()}
                        </p>
                    </div>`;
            $('#selected-seats').append(html);
            $('#counter').html(quantity);
            var vitri = $this.val().substring(2, 4);
            $('#' + vitri).attr('name', 'Ma' + vitri);
            $('#submit').attr('action', '/KhachHang/ChooseSeat/' + quantity)
        }
        else {
            quantity -= 1;
            var vitri = $this.val().substring(2, 4);
            $('#counter').html(quantity);
            $('#' + $this.val()).remove();
            $('#' + vitri).removeAttr('name');
            $('#submit').attr('action', '/KhachHang/ChooseSeat/' + quantity)
        }
    })
</script>